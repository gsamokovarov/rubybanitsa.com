<% e = EventDetails.new(event) %>

<% title e.title %>

<%= render 'events/ogp', e: e %>
<%= render jobs, highlight: true if e.upcoming? %>

<article class="event">
  <h1 class="<%= :upcoming if e.upcoming? && !jobs %>">
    <%= e.title %>
  </h1>
  <time datetime="<%= e.time.iso8601 %>"><%= e.human_datetime %></time>

  <%= render_markdown e.description %>

  <% if e.talks.present? %>
    <h2>Talks</h2>

    <%= render e.talks %>
  <% end %>

  <h2><%= event.venue.name %></h2>

  <% if event.venue.directions.present? %>
    <p><%= event.venue.directions %></p>
  <% end %>

  <% unless event.venue.online? %>
    <%= map_tag event %>
    <address><%= event.venue.address %></address>
  <% end %>

  <% if e.sponsorships.any? %>
    <h2>Thanks to</h2>

    <% e.companies.each do |company| %>
      <h3><%= company.name %></h3>
      <p><%= company.description %></p>
    <% end %>
  <% end %>

  <% if e.links? %>
    <h2>Links</h2>
      <% if e.facebook_url.present? %>
        <ul>
          <li><%= link_to 'Facebook', e.facebook_url %></li>
        </ul>
      <% end %>
  <% end %>

  <% if e.joinable? %>
    <%= link_to "Join us online", join_url, class: 'primary' %>
  <% else %>
    <%= link_to "Add to calendar", event_path(event, format: 'ics'), class: 'primary' %>
  <% end %>
</article>
